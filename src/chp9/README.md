# 9. 단위 테스트
* 제대로 된 테스트 케이스를 작성해야 한다.
## TDD 법칙 세가지
* TDD 법칙 세가지 - 30초 주기의 개발과 테스트
  1. 실패하는 단위 테스트를 작성할 때까지, 실제 코드를 작성하지 않는다.
  2. 컴파일은 실패하지 않으면서, 실행이 실패하는 정도로만 단위 테스트를 작성한다.
  3. 현재 실패하는 테스트를 통과할 정도로만 실제 코드를 작성한다.
* 위 법칙으로 테스트 코드를 작성하면, 방대한 테스트 코드가 나오지만, 관리문제를 유발하기도 함
## 깨끗한 테스트 코드 유지하기
* 지저분한 테스트 코드
  * 코드 변경할 때, 테스트 코드 변경하기 어려움
  * 새 버전을 출시할 때마다 유지부수 어려움
  * 변경 예측값이 큰 이유가 테스트 케이스가 되면 테스트 코드가 원인이라는 결론에 도달
  * 테스트 코드 폐기
  * 테스트 코드가 없으면, 코드가 제대로 도는지 확인할 수 없음
  * 결함률 높아짐
  * 의도하지 않은 결함 수가 많아지면, 개발자가 변경을 주저하고 코드를 정리하지 않음
* 테스트 코드는 실제 코드 못지 않게 깨끗해야 한다.
### 테스트는 유연성, 유지보수성, 재사용성을 제공한다.
* 테스트케이스가 없으면, 모든 변경이 잠정적 버그다.
* 테스트 코드가 지저분하면
  * 코드를 변경하는 능력이 떨어지고
  * 구조를 개선하는 능력도 떨어진다.
  * 테스트 코드 망, 실제 코드 망
## 깨끗한 테스트 코드
* 깨끗한 테스트 코드를 만들 때 가장 중요한 것: 가독성
  * 가독성을 높이려면 명료성, 단순성, 풍부한 표현력이 필요
* BUILD-OPERATE-CHECK 패턴
  * BUILD: 테스트 자료를 만든다.
  * OPERATE: 테스트 자료를 조작한다.
  * CHECK: 조작한 결과가 올바른지 확인
### 도메인에 특화된 테스트 언어
* 테스트를 위한 함수와 유틸리티를 구현한 후 사용
  * 간결, 표현력이 풍부하게 만들어 줌
### 이중 표준
* 실제 코드 표준과 테스트 API 코드에 적용하는 표준은 다름
  * 공통점: 간결, 표현력이 풍부
  * 차이점: 테스트 API 코드가 효율적인 필요는 없음
## 테스트 당 assert 하나
* 장점: assert 문이 하나라서 코드를 이해하기 쉽고 빠르다.
* 단점: 중복되는 코드가 많아진다.
  * TEMPLATE METHOD 패턴을 사용
    * given, when 을 부모 클래스에두고 then 을 자식 클래스에 둔다
  * @Before 에 given/when, @Test 함수에 then
* 테스트 당 assert 하나는 어렵지만 좋은 지침
  * assert 문을 줄이는게 좋긴 함
### 테스트 당 개념 하나
* 개념 당 assert 문을 최소로 줄여라.
* 테스트 함수 하나는 개념 하나만 테스트 하라.
## F.I.R.S.T
* 깨끗한 테스트는 아래 5가지 규칙을 따름
* Fast
  * 빨라야 함
  * 느리면
    * 자주돌리지 못함
    * 문제를 찾아내서 고치지 못한다.
    * 코드를 정리하지 못함
    * 코드 품질 망가짐
* Independent
  * 독리적이어야 함
  * 하나가 실패하면, 나머지 잇따라 실패
  * 후반 테스트가 찾아내야 할 결함이 숨겨짐
* Repeatable
  * 어떤 환경에서도 반복 가능해야 함
  * 실제 환경, QA 환경, 네트워크가 연결되지 않은 환경
  * 실패할 이유를 둘러댈 변경이 생기지 않게 관리
* Self-Validating
  * 성공, 아니면 실패
  * 그렇지 않으면 판단이 주관적이되고 수작업이 필요하게 됨
* Timely
  * 적시에 작성
    * 실제 코드를 구현하기 직전에
  * 실제 코드 먼저 작성할 경우
    * 테스트가 불가능한 실제코드를 설계할 수도 있음
## 결론
* 테스트 코드는 중요하다
  * 테스트 코드가 망가지면, 실제코드도 망가짐
* 테스트 코드는 실제 코드의 유연성, 유지보수성, 재사용성을 보존하고 강화한다.
* 테스트 API를 구현해, 도메인 특화 언어를 만들자
  * 테스트 코드 만들기 쉬워짐